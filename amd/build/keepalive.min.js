/**
 * Local plugin "Session keepalive" - JS Code
 *
 * @module    local_session_keepalive/keepalive
 * @copyright 2017 Alexander Bias, University of Ulm <alexander.bias@uni-ulm.de>
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_session_keepalive/keepalive",["jquery","core/config","core/log"],(function($,config,log){var keepaliveInterval=null,formElements=null,dirty=!1;function checkKeepAlive(){!0===dirty&&$.ajax({url:config.wwwroot+"/local/session_keepalive/sessionkeepalive_ajax.php",dataType:"json",type:"POST",data:{sesskey:config.sesskey,time:Date.now()},headers:{"Cache-Control":"no-cache",Expires:"-1"},error:function(request){403==request.status?clearInterval(keepaliveInterval):request.status>=300&&request.status<=399&&log.debug("moodle-local_session_keepalive-keepalive: A cached copy of the keepalive answer was returned so it's reliablity cannot be guaranteed")}})}function markDirty(){dirty=!0,formElements.off("change keyup keydown",markDirty)}return{init:function(params){null!==params.keepaliveinterval&&params.keepaliveinterval>0&&(formElements=$("#region-main input, #region-main textarea, #region-main select")).length>0&&(formElements.on("change keyup keydown",markDirty),keepaliveInterval=setInterval(checkKeepAlive,1e3*params.keepaliveinterval*60))}}}));

//# sourceMappingURL=keepalive.min.js.map